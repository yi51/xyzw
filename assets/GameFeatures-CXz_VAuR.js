import{d as ne,c as _,o as g,a as e,e as ce,u as ue,r as B,z as M,g as de,A as ee,F as ie,s as pe,n as J,x,i as Se,v as K,k as re,b as xe,B as Ce,m as F,j as k,w as D,l as L,t as ve,C as Ie,D as ye,E as Te,G as Me,q as De}from"./index-Bax7E3Q1.js";import{_ as me}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{R as Be,_ as Ue,u as ze}from"./deviceDetector-IQv8hI74.js";const We={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Oe=e("path",{d:"M480 128a64 64 0 0 0-64-64h-16V48.45c0-8.61-6.62-16-15.23-16.43A16 16 0 0 0 368 48v16H144V48.45c0-8.61-6.62-16-15.23-16.43A16 16 0 0 0 112 48v16H96a64 64 0 0 0-64 64v12a4 4 0 0 0 4 4h440a4 4 0 0 0 4-4z",fill:"currentColor"},null,-1),Ee=e("path",{d:"M32 416a64 64 0 0 0 64 64h320a64 64 0 0 0 64-64V179a3 3 0 0 0-3-3H35a3 3 0 0 0-3 3zm344-208a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm0 80a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm-80-80a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm0 80a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm0 80a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm-80-80a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm0 80a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm-80-80a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm0 80a24 24 0 1 1-24 24a24 24 0 0 1 24-24z",fill:"currentColor"},null,-1),Ae=[Oe,Ee],He=ne({name:"Calendar",render:function(a,i){return g(),_("svg",We,Ae)}}),Ne={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Re=e("path",{d:"M256 48C141.31 48 48 141.31 48 256s93.31 208 208 208s208-93.31 208-208S370.69 48 256 48zm108.25 138.29l-134.4 160a16 16 0 0 1-12 5.71h-.27a16 16 0 0 1-11.89-5.3l-57.6-64a16 16 0 1 1 23.78-21.4l45.29 50.32l122.59-145.91a16 16 0 0 1 24.5 20.58z",fill:"currentColor"},null,-1),Pe=[Re],Ve=ne({name:"CheckmarkCircle",render:function(a,i){return g(),_("svg",Ne,Pe)}}),Le={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ge=e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M112 184l144 144l144-144"},null,-1),je=[Ge],qe=ne({name:"ChevronDown",render:function(a,i){return g(),_("svg",Le,je)}}),Je={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Qe=e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M112 328l144-144l144 144"},null,-1),Xe=[Qe],Ye=ne({name:"ChevronUp",render:function(a,i){return g(),_("svg",Je,Xe)}}),Ke={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ze=e("path",{d:"M424.44 227.25a16 16 0 0 1-12.12-12.39c-7.68-36.68-24.45-68.15-49.18-92A153.57 153.57 0 0 0 256 80c-35.5 0-68.24 11.69-94.68 33.8a156.24 156.24 0 0 0-42 56a16 16 0 0 1-11.37 9.15c-27 5.62-51.07 17.34-69.18 33.87C13.39 235.88 0 267.42 0 304c0 36 14.38 68.88 40.49 92.59C65.64 419.43 99.56 432 136 432h260c32.37 0 60.23-8.57 80.59-24.77C499.76 388.78 512 361.39 512 328c0-57.57-42-90.58-87.56-100.75zm-95.2-8.94l-107.8 128a16 16 0 0 1-12 5.69h-.27a16 16 0 0 1-11.88-5.28l-45.9-50.87c-5.77-6.39-5.82-16.33.3-22.4a16 16 0 0 1 23.16.63l33.9 37.58l96-114a16 16 0 1 1 24.48 20.62z",fill:"currentColor"},null,-1),Fe=[Ze],et=ne({name:"CloudDone",render:function(a,i){return g(),_("svg",Ke,Fe)}}),tt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},st=e("path",{d:"M428 224H288a48 48 0 0 1-48-48V36a4 4 0 0 0-4-4h-92a64 64 0 0 0-64 64v320a64 64 0 0 0 64 64h224a64 64 0 0 0 64-64V228a4 4 0 0 0-4-4zm-92 160H176a16 16 0 0 1 0-32h160a16 16 0 0 1 0 32zm0-80H176a16 16 0 0 1 0-32h160a16 16 0 0 1 0 32z",fill:"currentColor"},null,-1),nt=e("path",{d:"M419.22 188.59L275.41 44.78a2 2 0 0 0-3.41 1.41V176a16 16 0 0 0 16 16h129.81a2 2 0 0 0 1.41-3.41z",fill:"currentColor"},null,-1),at=[st,nt],ot=ne({name:"DocumentText",render:function(a,i){return g(),_("svg",tt,at)}}),lt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},it=e("circle",{cx:"256",cy:"256",r:"192",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),rt=[it],ct=ne({name:"EllipseOutline",render:function(a,i){return g(),_("svg",lt,rt)}}),ut={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},dt=e("circle",{cx:"256",cy:"256",r:"48",fill:"currentColor"},null,-1),mt=e("path",{d:"M470.39 300l-.47-.38l-31.56-24.75a16.11 16.11 0 0 1-6.1-13.33v-11.56a16 16 0 0 1 6.11-13.22L469.92 212l.47-.38a26.68 26.68 0 0 0 5.9-34.06l-42.71-73.9a1.59 1.59 0 0 1-.13-.22A26.86 26.86 0 0 0 401 92.14l-.35.13l-37.1 14.93a15.94 15.94 0 0 1-14.47-1.29q-4.92-3.1-10-5.86a15.94 15.94 0 0 1-8.19-11.82l-5.59-39.59l-.12-.72A27.22 27.22 0 0 0 298.76 26h-85.52a26.92 26.92 0 0 0-26.45 22.39l-.09.56l-5.57 39.67a16 16 0 0 1-8.13 11.82a175.21 175.21 0 0 0-10 5.82a15.92 15.92 0 0 1-14.43 1.27l-37.13-15l-.35-.14a26.87 26.87 0 0 0-32.48 11.34l-.13.22l-42.77 73.95a26.71 26.71 0 0 0 5.9 34.1l.47.38l31.56 24.75a16.11 16.11 0 0 1 6.1 13.33v11.56a16 16 0 0 1-6.11 13.22L42.08 300l-.47.38a26.68 26.68 0 0 0-5.9 34.06l42.71 73.9a1.59 1.59 0 0 1 .13.22a26.86 26.86 0 0 0 32.45 11.3l.35-.13l37.07-14.93a15.94 15.94 0 0 1 14.47 1.29q4.92 3.11 10 5.86a15.94 15.94 0 0 1 8.19 11.82l5.56 39.59l.12.72A27.22 27.22 0 0 0 213.24 486h85.52a26.92 26.92 0 0 0 26.45-22.39l.09-.56l5.57-39.67a16 16 0 0 1 8.18-11.82c3.42-1.84 6.76-3.79 10-5.82a15.92 15.92 0 0 1 14.43-1.27l37.13 14.95l.35.14a26.85 26.85 0 0 0 32.48-11.34a2.53 2.53 0 0 1 .13-.22l42.71-73.89a26.7 26.7 0 0 0-5.89-34.11zm-134.48-40.24a80 80 0 1 1-83.66-83.67a80.21 80.21 0 0 1 83.66 83.67z",fill:"currentColor"},null,-1),pt=[dt,mt],ke=ne({name:"Settings",render:function(a,i){return g(),_("svg",ut,pt)}}),vt="/icons/173746572831736.png",gt="/icons/174061875626614.png",be="/icons/1733492491706148.png",ft="/icons/1736425783912140.png",_t="/icons/Ob7pyorzmHiJcbab2c25af264d0758b527bc1b61cc3b.png",ht={class:"team-status-card"},yt={class:"card-header"},kt={class:"team-selector"},wt=["disabled","onClick"],Tt=["disabled"],bt={class:"card-content"},$t={class:"team-display"},St={class:"current-team-info"},xt={class:"team-number"},Ct={class:"heroes-container"},It={key:0,class:"heroes-inline"},Mt={class:"hero-circle"},Dt=["src","alt"],Bt={key:1,class:"hero-placeholder"},Ut={class:"hero-name"},zt={key:1,class:"empty-team"},Wt={key:2,class:"empty-team"},Ot=ne({__name:"TeamStatus",setup(Q){const a={101:{name:"å¸é©¬æ‡¿",type:"é­å›½"},102:{name:"éƒ­å˜‰",type:"é­å›½"},103:{name:"å…³ç¾½",type:"èœ€å›½"},104:{name:"è¯¸è‘›äº®",type:"èœ€å›½"},105:{name:"å‘¨ç‘œ",type:"å´å›½"},106:{name:"å¤ªå²æ…ˆ",type:"å´å›½"},107:{name:"å•å¸ƒ",type:"ç¾¤é›„"},108:{name:"åä½—",type:"ç¾¤é›„"},109:{name:"ç”„å§¬",type:"é­å›½"},110:{name:"é»„æœˆè‹±",type:"èœ€å›½"},111:{name:"å­™ç­–",type:"å´å›½"},112:{name:"è´¾è¯©",type:"ç¾¤é›„"},113:{name:"æ›¹ä»",type:"é­å›½"},114:{name:"å§œç»´",type:"èœ€å›½"},115:{name:"å­™åš",type:"å´å›½"},116:{name:"å…¬å­™ç“’",type:"ç¾¤é›„"},117:{name:"å…¸éŸ¦",type:"é­å›½"},118:{name:"èµµäº‘",type:"èœ€å›½"},119:{name:"å¤§ä¹”",type:"å´å›½"},120:{name:"å¼ è§’",type:"ç¾¤é›„"},201:{name:"å¾æ™ƒ",type:"é­å›½"},202:{name:"è€å½§",type:"é­å›½"},203:{name:"å…¸éŸ¦",type:"é­å›½"},204:{name:"å¼ é£",type:"èœ€å›½"},205:{name:"èµµäº‘",type:"èœ€å›½"},206:{name:"åºç»Ÿ",type:"èœ€å›½"},207:{name:"é²è‚ƒ",type:"å´å›½"},208:{name:"é™†é€Š",type:"å´å›½"},209:{name:"ç”˜å®",type:"å´å›½"},210:{name:"è²‚è‰",type:"ç¾¤é›„"},211:{name:"è‘£å“",type:"ç¾¤é›„"},212:{name:"å¼ è§’",type:"ç¾¤é›„"},213:{name:"å¼ è¾½",type:"é­å›½"},214:{name:"å¤ä¾¯æƒ‡",type:"é­å›½"},215:{name:"è®¸è¤š",type:"é­å›½"},216:{name:"å¤ä¾¯æ¸Š",type:"é­å›½"},217:{name:"é­å»¶",type:"èœ€å›½"},218:{name:"é»„å¿ ",type:"èœ€å›½"},219:{name:"é©¬è¶…",type:"èœ€å›½"},220:{name:"é©¬å²±",type:"èœ€å›½"},221:{name:"å•è’™",type:"å´å›½"},222:{name:"é»„ç›–",type:"å´å›½"},223:{name:"è”¡æ–‡å§¬",type:"é­å›½"},224:{name:"å°ä¹”",type:"å´å›½"},225:{name:"è¢ç»",type:"ç¾¤é›„"},226:{name:"åé›„",type:"ç¾¤é›„"},227:{name:"é¢œè‰¯",type:"ç¾¤é›„"},228:{name:"æ–‡ä¸‘",type:"ç¾¤é›„"},301:{name:"å‘¨æ³°",type:"å´å›½"},302:{name:"è®¸æ”¸",type:"é­å›½"},303:{name:"äºç¦",type:"é­å›½"},304:{name:"å¼ æ˜Ÿå½©",type:"èœ€å›½"},305:{name:"å…³é“¶å±",type:"èœ€å›½"},306:{name:"å…³å¹³",type:"èœ€å›½"},307:{name:"ç¨‹æ™®",type:"å´å›½"},308:{name:"å¼ æ˜­",type:"å´å›½"},309:{name:"é™†ç»©",type:"å´å›½"},310:{name:"å•ç²ç»®",type:"ç¾¤é›„"},311:{name:"æ½˜å‡¤",type:"ç¾¤é›„"},312:{name:"é‚¢é“è£",type:"ç¾¤é›„"},313:{name:"ç¥èå¤«äºº",type:"ç¾¤é›„"},314:{name:"å­Ÿè·",type:"ç¾¤é›„"}},i=ce(),r=ue(),o=B(!1),A=B(!1),$=B(1),S=B([1,2,3,4]),f=M(()=>i.selectedToken?i.getWebSocketStatus(i.selectedToken.id):"disconnected"),z=M(()=>{var s;return((s=i.gameData)==null?void 0:s.presetTeam)??null});function Y(s){var ae;if(!s)return{useTeamId:1,teams:{}};const n=s.presetTeamInfo??s,d=q=>{if(!q||typeof q!="object")return null;if(typeof q.useTeamId=="number")return q.useTeamId;for(const te of Object.keys(q)){const j=d(q[te]);if(j)return j}return null},m=n.useTeamId??((ae=n.presetTeamInfo)==null?void 0:ae.useTeamId)??d(n)??1,y=n.presetTeamInfo??n,I={},N=Object.keys(y||{}).filter(q=>/^\d+$/.test(q));for(const q of N){const te=Number(q),j=y[q];if(!j){I[te]={teamInfo:{}};continue}if(j.teamInfo)I[te]={teamInfo:j.teamInfo};else if(j.heroes){const oe={};j.heroes.forEach((le,c)=>{oe[String(c+1)]=le}),I[te]={teamInfo:oe}}else if(typeof j=="object"){const oe=Object.values(j).some(le=>le&&typeof le=="object"&&"heroId"in le);I[te]={teamInfo:oe?j:{}}}else I[te]={teamInfo:{}}}return{useTeamId:Number(m)||1,teams:I}}const W=M(()=>Y(z.value)),G=M(()=>{var d;const s=(d=W.value.teams[$.value])==null?void 0:d.teamInfo;if(!s)return[];const n=[];for(const[m,y]of Object.entries(s)){const I=(y==null?void 0:y.heroId)??(y==null?void 0:y.id);if(!I)continue;const N=a[Number(I)];n.push({id:Number(I),name:(N==null?void 0:N.name)??`è‹±é›„${I}`,type:(N==null?void 0:N.type)??"",position:Number(m),level:(y==null?void 0:y.level)??1,avatar:y==null?void 0:y.avatar})}return n.sort((m,y)=>m.position-y.position),n}),h=async(s,n,d={},m="",y=8e3)=>{try{return await i.sendMessageWithPromise(s,n,d,y)}catch(I){const N=(I==null?void 0:I.message)??String(I);throw m&&r.error(`${m}å¤±è´¥ï¼š${N}`),I}},T=async(s=!1)=>{var d,m;if(!i.selectedToken)return r.warning("è¯·å…ˆé€‰æ‹©Token"),null;const n=i.selectedToken.id;if(!s){const y=(m=(d=i.gameData)==null?void 0:d.presetTeam)==null?void 0:m.presetTeamInfo;if(y)return y}o.value=!0;try{const y=await h(n,"presetteam_getinfo",{},"è·å–é˜µå®¹ä¿¡æ¯");return i.$patch(I=>{I.gameData={...I.gameData??{},presetTeam:y}}),(y==null?void 0:y.presetTeamInfo)??null}catch(y){return console.error("è·å–é˜µå®¹ä¿¡æ¯å¤±è´¥:",y),null}finally{o.value=!1}},C=()=>{const s=Object.keys(W.value.teams).map(Number).filter(n=>!Number.isNaN(n)).sort((n,d)=>n-d);S.value=s.length?s:[1,2,3,4]},O=()=>{$.value=W.value.useTeamId||1},P=async s=>{if(A.value||o.value)return;if(!i.selectedToken){r.warning("è¯·å…ˆé€‰æ‹©Token");return}const n=$.value;A.value=!0;try{await h(i.selectedToken.id,"presetteam_saveteam",{teamId:s},`åˆ‡æ¢åˆ°é˜µå®¹ ${s}`),$.value=s,r.success(`å·²åˆ‡æ¢åˆ°é˜µå®¹ ${s}`),await l(!0)}catch{$.value=n}finally{A.value=!1}},l=async(s=!1)=>{await T(s)};return de(async()=>{i.selectedToken&&f.value==="connected"?(await l(!1),C(),O(),z.value||(await l(!0),C(),O())):i.selectedToken?console.log("ğŸ›¡ï¸ WebSocketæœªè¿æ¥ï¼Œç­‰å¾…è¿æ¥åè‡ªåŠ¨è·å–é˜Ÿä¼ä¿¡æ¯"):console.log("ğŸ›¡ï¸ æ²¡æœ‰é€‰ä¸­çš„Tokenï¼Œæ— æ³•è·å–é˜Ÿä¼ä¿¡æ¯")}),ee(f,(s,n)=>{console.log(`ğŸ›¡ï¸ WebSocketçŠ¶æ€å˜åŒ–: ${n} -> ${s}`),s==="connected"&&n!=="connected"&&i.selectedToken&&(console.log("ğŸ›¡ï¸ WebSocketå·²è¿æ¥ï¼Œè‡ªåŠ¨è·å–é˜Ÿä¼ä¿¡æ¯"),setTimeout(async()=>{await l(!1),C(),O(),z.value||(await l(!0),C(),O())},1e3))}),ee(()=>i.selectedToken,async(s,n)=>{s&&s.id!==(n==null?void 0:n.id)&&(console.log("ğŸ›¡ï¸ Tokenå·²åˆ‡æ¢ï¼Œé‡æ–°è·å–é˜Ÿä¼ä¿¡æ¯"),i.getWebSocketStatus(s.id)==="connected"&&(await l(!0),C(),O()))}),ee(()=>z.value,()=>{C(),O()},{deep:!0}),(s,n)=>(g(),_("div",ht,[e("div",yt,[n[2]||(n[2]=e("img",{src:_t,alt:"é˜Ÿä¼å›¾æ ‡",class:"team-icon"},null,-1)),n[3]||(n[3]=e("div",{class:"team-info"},[e("h3",null,"é˜Ÿä¼é˜µå®¹"),e("p",null,"å½“å‰ä½¿ç”¨çš„æˆ˜æ–—é˜µå®¹")],-1)),e("div",kt,[(g(!0),_(ie,null,pe(S.value,d=>(g(),_("button",{key:d,disabled:o.value||A.value,class:J(["team-button",{active:$.value===d}]),onClick:m=>P(d)},x(d),11,wt))),128)),e("button",{class:"refresh-button",disabled:o.value,title:"åˆ·æ–°é˜Ÿä¼æ•°æ®",onClick:n[0]||(n[0]=d=>l(!0))},n[1]||(n[1]=[Se('<svg class="refresh-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-43018590><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8" data-v-43018590></path><path d="M21 3v5h-5" data-v-43018590></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16" data-v-43018590></path><path d="M3 21v-5h5" data-v-43018590></path></svg><span class="refresh-text" data-v-43018590>åˆ·æ–°</span>',2)]),8,Tt)])]),e("div",bt,[e("div",$t,[e("div",St,[n[4]||(n[4]=e("span",{class:"label"},"å½“å‰é˜µå®¹",-1)),e("span",xt,[o.value?(g(),_(ie,{key:1},[K("åŠ è½½ä¸­â€¦")],64)):(g(),_(ie,{key:0},[K("é˜µå®¹ "+x($.value),1)],64))])]),e("div",Ct,[o.value?re("",!0):(g(),_("div",It,[(g(!0),_(ie,null,pe(G.value,d=>{var m;return g(),_("div",{key:d.id||d.name,class:"hero-item"},[e("div",Mt,[d.avatar?(g(),_("img",{key:0,src:d.avatar,alt:d.name,class:"hero-avatar"},null,8,Dt)):(g(),_("div",Bt,x(((m=d.name)==null?void 0:m.substring(0,2))||"?"),1))]),e("span",Ut,x(d.name||"æœªçŸ¥"),1)])}),128))])),!o.value&&!G.value.length?(g(),_("div",zt,n[5]||(n[5]=[e("p",null,"æš‚æ— é˜Ÿä¼ä¿¡æ¯",-1)]))):re("",!0),o.value?(g(),_("div",Wt,n[6]||(n[6]=[e("p",null,"æ­£åœ¨åŠ è½½é˜Ÿä¼ä¿¡æ¯â€¦",-1)]))):re("",!0)])])])]))}}),Et=me(Ot,[["__scopeId","data-v-43018590"]]),At="/icons/174023274867420.png",Ht={class:"daily-task-container"},Nt={class:"task-header"},Rt={class:"header-right"},Pt={class:"progress-container"},Vt=["disabled"],Lt={key:0,class:"loading-text"},Gt={key:1},jt={key:2},qt={class:"modal-header"},Jt={class:"settings-content"},Qt={class:"settings-grid"},Xt={class:"setting-item"},Yt={class:"setting-item"},Kt={class:"setting-item"},Zt={class:"setting-switches"},Ft={class:"switch-row"},es={class:"switch-row"},ts={class:"switch-row"},ss={class:"switch-row"},ns={class:"switch-row"},as={class:"switch-row"},os={class:"switch-row"},ls={class:"modal-header"},is=["disabled"],rs={class:"task-list"},cs={class:"task-item-left"},us={class:"task-name"},ds={class:"modal-header"},ms={class:"log-time"},we=500,ps={__name:"DailyTaskStatus",setup(Q){const a=ce(),i=ue(),r=B(!1),o=B(!1),A=B(!1),$=B(!1),S=B(null),f=xe({arenaFormation:1,bossFormation:1,bossTimes:4,claimBottle:!0,payRecruit:!0,openBox:!0,arenaEnable:!0,claimHangUp:!0,claimEmail:!0,blackMarketPurchase:!0}),z=B([{id:1,name:"ç™»å½•ä¸€æ¬¡æ¸¸æˆ",completed:!1,loading:!1},{id:2,name:"åˆ†äº«ä¸€æ¬¡æ¸¸æˆ",completed:!1,loading:!1},{id:3,name:"èµ é€å¥½å‹3æ¬¡é‡‘å¸",completed:!1,loading:!1},{id:4,name:"è¿›è¡Œ2æ¬¡æ‹›å‹Ÿ",completed:!1,loading:!1},{id:5,name:"é¢†å–5æ¬¡æŒ‚æœºå¥–åŠ±",completed:!1,loading:!1},{id:6,name:"è¿›è¡Œ3æ¬¡ç‚¹é‡‘",completed:!1,loading:!1},{id:7,name:"å¼€å¯3æ¬¡å®ç®±",completed:!1,loading:!1},{id:12,name:"é»‘å¸‚è´­ä¹°1æ¬¡ç‰©å“ï¼ˆè¯·è®¾ç½®é‡‡è´­æ¸…å•ï¼‰",completed:!1,loading:!1},{id:13,name:"è¿›è¡Œ1åœºç«æŠ€åœºæˆ˜æ–—",completed:!1,loading:!1},{id:14,name:"æ”¶è·1ä¸ªä»»æ„ç›ç½",completed:!1,loading:!1}]),Y=[1,2,3,4].map(c=>({label:`é˜µå®¹${c}`,value:c})),W=[0,1,2,3,4].map(c=>({label:`${c}æ¬¡`,value:c})),G=M(()=>a.selectedTokenRoleInfo),h=M(()=>{var c,t,w;return((w=(t=(c=G.value)==null?void 0:c.role)==null?void 0:t.dailyTask)==null?void 0:w.dailyPoint)??0}),T=M(()=>Math.min(h.value,100)),C=M(()=>T.value>=100),O=M(()=>C.value?"#10b981":"#3b82f6"),P=M(()=>a.selectedToken?a.getWebSocketStatus(a.selectedToken.id)==="connected":!1),l=B([]),s=(c,t="info")=>{const w=new Date().toLocaleTimeString();l.value.push({time:w,message:c,type:t}),l.value.length>we&&l.value.splice(0,l.value.length-we),Ie(()=>{S.value&&(S.value.scrollTop=S.value.scrollHeight)})},n=c=>{var U,E;if(!((E=(U=c==null?void 0:c.role)==null?void 0:U.dailyTask)!=null&&E.complete)){s("è§’è‰²ä¿¡æ¯ä¸­æ— ä»»åŠ¡å®Œæˆæ•°æ®","warning");return}const t=c.role.dailyTask.complete,w=H=>H===-1;s("å¼€å§‹åŒæ­¥ä»»åŠ¡å®ŒæˆçŠ¶æ€..."),s(`æœåŠ¡å™¨è¿”å›çš„ä»»åŠ¡å®Œæˆæ•°æ®: ${JSON.stringify(t)}`);let p=0,R=0;z.value.forEach(H=>{H.completed=!1}),Object.keys(t).forEach(H=>{const u=Number(H),b=z.value.findIndex(se=>se.id===u);if(b>=0){const se=w(t[H]);z.value[b].completed=se,p++,se&&R++,s(`ä»»åŠ¡${u} "${z.value[b].name}": ${se?"å·²å®Œæˆ":"æœªå®Œæˆ"}`,se?"success":"info")}else s(`æœåŠ¡å™¨è¿”å›æœªçŸ¥ä»»åŠ¡ID: ${u} (å®Œæˆå€¼: ${t[H]})`,"warning")}),s(`ä»»åŠ¡çŠ¶æ€åŒæ­¥å®Œæˆ: ${R}/${p} å·²å®Œæˆ`),s(`å½“å‰è¿›åº¦: ${h.value}/100`)},d=async()=>{if(!a.selectedToken)throw new Error("æ²¡æœ‰é€‰ä¸­çš„Token");const c=a.selectedToken.id;s("æ­£åœ¨è·å–è§’è‰²ä¿¡æ¯...");try{const t=await a.sendGetRoleInfo(c);return s("è§’è‰²ä¿¡æ¯è·å–æˆåŠŸ","success"),t&&n(t),t}catch(t){throw s(`è·å–è§’è‰²ä¿¡æ¯å¤±è´¥: ${t.message}`,"error"),t}},m=async(c,t,w={},p="",R=8e3)=>{try{p&&s(`æ‰§è¡Œ: ${p}`);const U=await a.sendMessageWithPromise(c,t,w,R);return p&&s(`${p} - æˆåŠŸ`,"success"),U}catch(U){throw p&&s(`${p} - å¤±è´¥: ${U.message}`,"error"),U}},y=c=>{if(!c)return!0;const t=new Date().toDateString(),w=new Date(c).toDateString();return t!==w},I=()=>{const c=[9904,9905,9901,9902,9903,9904,9905],t=new Date().getDay();return c[t]},N=async(c,t,w,p)=>{var R,U,E;try{const H=(U=(R=a.gameData)==null?void 0:R.presetTeam)==null?void 0:U.presetTeamInfo;let u=H==null?void 0:H.useTeamId;if(u)p(`ä»ç¼“å­˜è·å–å½“å‰é˜µå®¹: ${u}`);else{p("ç¼“å­˜ä¸­æ— é˜µå®¹ä¿¡æ¯ï¼Œä»æœåŠ¡å™¨è·å–...");const b=await m(c,"presetteam_getinfo",{},"è·å–é˜µå®¹ä¿¡æ¯");u=(E=b==null?void 0:b.presetTeamInfo)==null?void 0:E.useTeamId,p(`ä»æœåŠ¡å™¨è·å–å½“å‰é˜µå®¹: ${u}`)}return u===t?(p(`å½“å‰å·²æ˜¯${w}${t}ï¼Œæ— éœ€åˆ‡æ¢`,"success"),!1):(p(`å½“å‰é˜µå®¹: ${u}, ç›®æ ‡é˜µå®¹: ${t}ï¼Œå¼€å§‹åˆ‡æ¢...`),await m(c,"presetteam_saveteam",{teamId:t},`åˆ‡æ¢åˆ°${w}${t}`),p(`æˆåŠŸåˆ‡æ¢åˆ°${w}${t}`,"success"),!0)}catch(H){p(`é˜µå®¹æ£€æŸ¥å¤±è´¥ï¼Œç›´æ¥åˆ‡æ¢: ${H.message}`,"warning");try{return await m(c,"presetteam_saveteam",{teamId:t},`å¼ºåˆ¶åˆ‡æ¢åˆ°${w}${t}`),!0}catch(u){throw p(`å¼ºåˆ¶åˆ‡æ¢ä¹Ÿå¤±è´¥: ${u.message}`,"error"),u}}},ae=async(c,t,w)=>{var _e;const p=a.selectedToken.id,R=c==null?void 0:c.role;if(!R)throw new Error("è§’è‰²æ•°æ®ä¸å­˜åœ¨");t("å¼€å§‹æ‰§è¡Œæ¯æ—¥ä»»åŠ¡è¡¥å·®");const U=((_e=R.dailyTask)==null?void 0:_e.complete)??{},E=v=>U[v]===-1,H=R.statistics??{},u=R.statisticsTime??{},b=[];if(E(2)||b.push({name:"åˆ†äº«ä¸€æ¬¡æ¸¸æˆ",execute:()=>m(p,"system_mysharecallback",{isSkipShareCard:!0,type:2},"åˆ†äº«æ¸¸æˆ")}),E(3)||b.push({name:"èµ é€å¥½å‹é‡‘å¸",execute:()=>m(p,"friend_batch",{},"èµ é€å¥½å‹é‡‘å¸")}),E(4)||(b.push({name:"å…è´¹æ‹›å‹Ÿ",execute:()=>m(p,"hero_recruit",{recruitType:3,recruitNumber:1},"å…è´¹æ‹›å‹Ÿ")}),f.payRecruit&&b.push({name:"ä»˜è´¹æ‹›å‹Ÿ",execute:()=>m(p,"hero_recruit",{recruitType:1,recruitNumber:1},"ä»˜è´¹æ‹›å‹Ÿ")})),!E(6)&&y(u["buy:gold"]))for(let v=0;v<3;v++)b.push({name:`å…è´¹ç‚¹é‡‘ ${v+1}/3`,execute:()=>m(p,"system_buygold",{buyNum:1},`å…è´¹ç‚¹é‡‘ ${v+1}`)});if(!E(5)&&f.claimHangUp){for(let v=0;v<4;v++)b.push({name:`æŒ‚æœºåŠ é’Ÿ ${v+1}/4`,execute:()=>m(p,"system_mysharecallback",{isSkipShareCard:!0,type:2},`æŒ‚æœºåŠ é’Ÿ ${v+1}`)});b.push({name:"é¢†å–æŒ‚æœºå¥–åŠ±",execute:()=>m(p,"system_claimhangupreward",{},"é¢†å–æŒ‚æœºå¥–åŠ±")}),b.push({name:"æŒ‚æœºåŠ é’Ÿ 5/5",execute:()=>m(p,"system_mysharecallback",{isSkipShareCard:!0,type:2},"æŒ‚æœºåŠ é’Ÿ 5")})}if(!E(7)&&f.openBox&&b.push({name:"å¼€å¯æœ¨è´¨å®ç®±",execute:()=>m(p,"item_openbox",{itemId:2001,number:10},"å¼€å¯æœ¨è´¨å®ç®±10ä¸ª")}),!E(14)&&f.claimBottle&&b.push({name:"é¢†å–ç›ç½å¥–åŠ±",execute:()=>m(p,"bottlehelper_claim",{},"é¢†å–ç›ç½å¥–åŠ±")}),!E(13)&&f.arenaEnable&&b.push({name:"ç«æŠ€åœºæˆ˜æ–—",execute:async()=>{var v,Z;t("å¼€å§‹ç«æŠ€åœºæˆ˜æ–—æµç¨‹"),await N(p,f.arenaFormation,"ç«æŠ€åœºé˜µå®¹",t),await m(p,"arena_startarea",{},"å¼€å§‹ç«æŠ€åœº");for(let X=1;X<=3;X++){t(`ç«æŠ€åœºæˆ˜æ–— ${X}/3`);const V=await m(p,"arena_getareatarget",{refresh:!1},`è·å–ç«æŠ€åœºç›®æ ‡${X}`),he=(Z=(v=V==null?void 0:V.roleList)==null?void 0:v[0])==null?void 0:Z.roleId;he?await m(p,"fight_startareaarena",{targetId:he},`ç«æŠ€åœºæˆ˜æ–—${X}`,1e4):t(`ç«æŠ€åœºæˆ˜æ–—${X} - æœªæ‰¾åˆ°ç›®æ ‡`,"warning"),await new Promise($e=>setTimeout($e,1e3))}}}),f.bossTimes>0){const v=H["legion:boss"]??0,Z=Math.max(f.bossTimes-v,0);if(Z>0){b.push({name:"å†›å›¢BOSSé˜µå®¹æ£€æŸ¥",execute:()=>N(p,f.bossFormation,"BOSSé˜µå®¹",t)});for(let V=0;V<Z;V++)b.push({name:`å†›å›¢BOSS ${V+1}/${Z}`,execute:()=>m(p,"fight_startlegionboss",{},`å†›å›¢BOSS ${V+1}`,12e3)})}const X=I();Z===0&&b.push({name:"æ¯æ—¥BOSSé˜µå®¹æ£€æŸ¥",execute:()=>N(p,f.bossFormation,"BOSSé˜µå®¹",t)});for(let V=0;V<3;V++)b.push({name:`æ¯æ—¥BOSS ${V+1}/3`,execute:()=>m(p,"fight_startboss",{bossId:X},`æ¯æ—¥BOSS ${V+1}`,12e3)})}const se=[{name:"ç¦åˆ©ç­¾åˆ°",cmd:"system_signinreward"},{name:"ä¿±ä¹éƒ¨ç­¾åˆ°",cmd:"legion_signin"},{name:"é¢†å–æ¯æ—¥ç¤¼åŒ…",cmd:"discount_claimreward"},{name:"é¢†å–å…è´¹ç¤¼åŒ…",cmd:"card_claimreward"},{name:"é¢†å–æ°¸ä¹…å¡ç¤¼åŒ…",cmd:"card_claimreward",params:{cardId:4003}}];if(f.claimEmail&&se.push({name:"é¢†å–é‚®ä»¶å¥–åŠ±",cmd:"mail_claimallattachment"}),se.forEach(v=>{b.push({name:v.name,execute:()=>m(p,v.cmd,v.params||{},v.name)})}),y(u["artifact:normal:lottery:time"]))for(let v=0;v<3;v++)b.push({name:`å…è´¹é’“é±¼ ${v+1}/3`,execute:()=>m(p,"artifact_lottery",{lotteryNumber:1,newFree:!0,type:1},`å…è´¹é’“é±¼ ${v+1}`)});const ge=["é­å›½","èœ€å›½","å´å›½","ç¾¤é›„"];for(let v=1;v<=4;v++)y(u[`genie:daily:free:${v}`])&&b.push({name:`${ge[v-1]}ç¯ç¥å…è´¹æ‰«è¡`,execute:()=>m(p,"genie_sweep",{genieId:v},`${ge[v-1]}ç¯ç¥å…è´¹æ‰«è¡`)});for(let v=0;v<3;v++)b.push({name:`é¢†å–å…è´¹æ‰«è¡å· ${v+1}/3`,execute:()=>m(p,"genie_buysweep",{},`é¢†å–å…è´¹æ‰«è¡å· ${v+1}`)});!E(12)&&f.blackMarketPurchase&&b.push({name:"é»‘å¸‚è´­ä¹°1æ¬¡ç‰©å“",execute:()=>m(p,"store_purchase",{goodsId:1},"é»‘å¸‚è´­ä¹°1æ¬¡ç‰©å“")});for(let v=1;v<=10;v++)b.push({name:`é¢†å–ä»»åŠ¡å¥–åŠ±${v}`,execute:()=>m(p,"task_claimdailypoint",{taskId:v},`é¢†å–ä»»åŠ¡å¥–åŠ±${v}`,5e3)});b.push({name:"é¢†å–æ—¥å¸¸ä»»åŠ¡å¥–åŠ±",execute:()=>m(p,"task_claimdailyreward",{},"é¢†å–æ—¥å¸¸ä»»åŠ¡å¥–åŠ±")},{name:"é¢†å–å‘¨å¸¸ä»»åŠ¡å¥–åŠ±",execute:()=>m(p,"task_claimweekreward",{},"é¢†å–å‘¨å¸¸ä»»åŠ¡å¥–åŠ±")});const fe=b.length;t(`å…±æœ‰ ${fe} ä¸ªä»»åŠ¡å¾…æ‰§è¡Œ`);for(let v=0;v<b.length;v++){const Z=b[v];try{await Z.execute();const X=Math.floor((v+1)/fe*100);w&&w(p,X),await new Promise(V=>setTimeout(V,500))}catch(X){t(`ä»»åŠ¡æ‰§è¡Œå¤±è´¥: ${Z.name} - ${X.message}`,"error")}}w&&w(p,100),t("æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œå®Œæˆ","success"),await new Promise(v=>setTimeout(v,2e3)),await d()},q=async()=>{var c;if(!a.selectedToken||$.value){i.warning("æ²¡æœ‰é€‰ä¸­Tokenæˆ–æ­£åœ¨æ‰§è¡Œä¸­");return}if(!P.value){i.error("WebSocketè¿æ¥æœªå»ºç«‹ï¼Œè¯·æ£€æŸ¥è¿æ¥çŠ¶æ€");return}$.value=!0,A.value=!0,l.value=[];try{s("=== å¼€å§‹æ‰§è¡Œä¸€é”®è¡¥å·®ä»»åŠ¡ ===");const t=await d();if(!(t!=null&&t.role))throw new Error("è·å–è§’è‰²ä¿¡æ¯å¤±è´¥æˆ–æ•°æ®å¼‚å¸¸");s(`å½“å‰æ¯æ—¥ä»»åŠ¡è¿›åº¦: ${((c=t.role.dailyTask)==null?void 0:c.dailyPoint)||0}/100`),s("ç¬¬äºŒæ­¥: å¼€å§‹æ‰§è¡Œæ¯æ—¥ä»»åŠ¡..."),await ae(t,s,(w,p)=>{s(`ä»»åŠ¡è¿›åº¦: ${p}%`)}),s("=== ä»»åŠ¡æ‰§è¡Œå®Œæˆ ===","success"),i.success("æ¯æ—¥ä»»åŠ¡è¡¥å·®æ‰§è¡Œå®Œæˆ"),setTimeout(async()=>{try{await d(),s("æœ€ç»ˆè§’è‰²ä¿¡æ¯åˆ·æ–°å®Œæˆ","success")}catch(w){s(`æœ€ç»ˆåˆ·æ–°å¤±è´¥: ${w.message}`,"warning")}},3e3)}catch(t){s(`ä»»åŠ¡æ‰§è¡Œå¤±è´¥: ${t.message}`,"error"),console.error("è¯¦ç»†é”™è¯¯ä¿¡æ¯:",t),i.error(`ä»»åŠ¡æ‰§è¡Œå¤±è´¥: ${t.message}`)}finally{$.value=!1}},te=async()=>{if(!P.value){i.warning("WebSocketæœªè¿æ¥ï¼Œæ— æ³•åˆ·æ–°ä»»åŠ¡çŠ¶æ€");return}try{s("æ‰‹åŠ¨åˆ·æ–°ä»»åŠ¡çŠ¶æ€..."),await d(),i.success("ä»»åŠ¡çŠ¶æ€åˆ·æ–°æˆåŠŸ")}catch(c){s(`åˆ·æ–°å¤±è´¥: ${c.message}`,"error"),i.error(`åˆ·æ–°å¤±è´¥: ${c.message}`)}},j=()=>a.selectedToken?{roleId:a.selectedToken.id}:null,oe=c=>{try{const t=localStorage.getItem(`daily-settings:${c}`);return t?JSON.parse(t):null}catch(t){return console.error("Failed to load settings:",t),null}},le=(c,t)=>{try{localStorage.setItem(`daily-settings:${c}`,JSON.stringify(t))}catch(w){console.error("Failed to save settings:",w)}};return ee(f,c=>{const t=j();t&&le(t.roleId,c)},{deep:!0}),ee(()=>a.selectedToken,async(c,t)=>{if(c&&c!==t){s(`åˆ‡æ¢åˆ°Token: ${c.name}`);const w=oe(c.id);if(w&&Object.assign(f,w),P.value)try{await d()}catch(p){console.warn("åˆ‡æ¢tokenåè·å–è§’è‰²ä¿¡æ¯å¤±è´¥:",p.message)}}},{immediate:!0}),ee(()=>a.selectedTokenRoleInfo,c=>{var t,w;(w=(t=c==null?void 0:c.role)==null?void 0:t.dailyTask)!=null&&w.complete&&(s("è§’è‰²ä¿¡æ¯æ›´æ–°ï¼ŒåŒæ­¥ä»»åŠ¡çŠ¶æ€"),n(c))},{immediate:!0,deep:!0}),de(async()=>{if(s("ç»„ä»¶åˆå§‹åŒ–å®Œæˆ"),a.selectedToken&&P.value)try{await d()}catch(t){console.warn("åˆå§‹åŒ–æ—¶è·å–è§’è‰²ä¿¡æ¯å¤±è´¥:",t.message)}const c=j();if(c){const t=oe(c.roleId);t&&Object.assign(f,t)}}),Ce(()=>{s("ç»„ä»¶å³å°†å¸è½½")}),(c,t)=>{const w=F("n-icon"),p=F("n-progress"),R=F("n-select"),U=F("n-switch"),E=F("n-modal"),H=F("n-tag");return g(),_("div",Ht,[e("div",Nt,[t[16]||(t[16]=e("div",{class:"header-left"},[e("img",{src:At,alt:"æ¯æ—¥ä»»åŠ¡",class:"task-icon"}),e("div",{class:"title-container"},[e("h3",null,"æ¯æ—¥ä»»åŠ¡"),e("p",null,"å½“å‰è¿›åº¦")])],-1)),e("div",Rt,[e("div",{class:J(["status-indicator",{completed:C.value}]),onClick:t[0]||(t[0]=u=>o.value=!0)},[e("div",{class:J(["status-dot",{completed:C.value}])},null,2),t[15]||(t[15]=e("span",null,"ä»»åŠ¡è¯¦æƒ…",-1))],2),e("button",{class:"settings-button",onClick:t[1]||(t[1]=u=>r.value=!0)},[k(w,null,{default:D(()=>[k(L(ke))]),_:1})])])]),e("div",Pt,[k(p,{type:"line",percentage:T.value,height:8,"border-radius":4,color:O.value,"rail-color":"#f3f4f6"},null,8,["percentage","color"])]),t[32]||(t[32]=e("div",{class:"info-container"}," å³ä¸Šè§’å°é½¿è½®æœ‰æƒŠå–œ ",-1)),e("button",{class:"execute-button",disabled:$.value||!P.value,onClick:q},[$.value?(g(),_("span",Lt,t[17]||(t[17]=[e("svg",{class:"loading-icon",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M12 22c5.421 0 10-4.579 10-10h-2c0 4.337-3.663 8-8 8s-8-3.663-8-8c0-4.336 3.663-8 8-8V2C6.579 2 2 6.58 2 12c0 5.421 4.579 10 10 10z"})],-1),K(" æ‰§è¡Œä¸­... ",-1)]))):P.value?(g(),_("span",jt,"ä¸€é”®è¡¥å·®")):(g(),_("span",Gt,"WebSocketæœªè¿æ¥"))],8,Vt),k(E,{show:r.value,"onUpdate:show":t[12]||(t[12]=u=>r.value=u),preset:"card",title:"ä»»åŠ¡è®¾ç½®",style:{width:"400px"}},{header:D(()=>[e("div",qt,[k(w,null,{default:D(()=>[k(L(ke))]),_:1}),t[18]||(t[18]=e("span",null,"ä»»åŠ¡è®¾ç½®",-1))])]),default:D(()=>[e("div",Jt,[e("div",Qt,[e("div",Xt,[t[19]||(t[19]=e("label",{class:"setting-label"},"ç«æŠ€åœºé˜µå®¹",-1)),k(R,{value:f.arenaFormation,"onUpdate:value":t[2]||(t[2]=u=>f.arenaFormation=u),options:L(Y),size:"small"},null,8,["value","options"])]),e("div",Yt,[t[20]||(t[20]=e("label",{class:"setting-label"},"BOSSé˜µå®¹",-1)),k(R,{value:f.bossFormation,"onUpdate:value":t[3]||(t[3]=u=>f.bossFormation=u),options:L(Y),size:"small"},null,8,["value","options"])]),e("div",Kt,[t[21]||(t[21]=e("label",{class:"setting-label"},"BOSSæ¬¡æ•°",-1)),k(R,{value:f.bossTimes,"onUpdate:value":t[4]||(t[4]=u=>f.bossTimes=u),options:L(W),size:"small"},null,8,["value","options"])]),e("div",Zt,[e("div",Ft,[t[22]||(t[22]=e("span",{class:"switch-label"},"é¢†ç½å­",-1)),k(U,{value:f.claimBottle,"onUpdate:value":t[5]||(t[5]=u=>f.claimBottle=u)},null,8,["value"])]),e("div",es,[t[23]||(t[23]=e("span",{class:"switch-label"},"é¢†æŒ‚æœº",-1)),k(U,{value:f.claimHangUp,"onUpdate:value":t[6]||(t[6]=u=>f.claimHangUp=u)},null,8,["value"])]),e("div",ts,[t[24]||(t[24]=e("span",{class:"switch-label"},"ç«æŠ€åœº",-1)),k(U,{value:f.arenaEnable,"onUpdate:value":t[7]||(t[7]=u=>f.arenaEnable=u)},null,8,["value"])]),e("div",ss,[t[25]||(t[25]=e("span",{class:"switch-label"},"å¼€å®ç®±",-1)),k(U,{value:f.openBox,"onUpdate:value":t[8]||(t[8]=u=>f.openBox=u)},null,8,["value"])]),e("div",ns,[t[26]||(t[26]=e("span",{class:"switch-label"},"é¢†å–é‚®ä»¶å¥–åŠ±",-1)),k(U,{value:f.claimEmail,"onUpdate:value":t[9]||(t[9]=u=>f.claimEmail=u)},null,8,["value"])]),e("div",as,[t[27]||(t[27]=e("span",{class:"switch-label"},"é»‘å¸‚è´­ä¹°ç‰©å“",-1)),k(U,{value:f.blackMarketPurchase,"onUpdate:value":t[10]||(t[10]=u=>f.blackMarketPurchase=u)},null,8,["value"])]),e("div",os,[t[28]||(t[28]=e("span",{class:"switch-label"},"ä»˜è´¹æ‹›å‹Ÿ",-1)),k(U,{value:f.payRecruit,"onUpdate:value":t[11]||(t[11]=u=>f.payRecruit=u)},null,8,["value"])])])])])]),_:1},8,["show"]),k(E,{show:o.value,"onUpdate:show":t[13]||(t[13]=u=>o.value=u),preset:"card",title:"æ¯æ—¥ä»»åŠ¡è¯¦æƒ…",style:{width:"400px"}},{header:D(()=>[e("div",ls,[k(w,null,{default:D(()=>[k(L(He))]),_:1}),t[30]||(t[30]=e("span",null,"æ¯æ—¥ä»»åŠ¡è¯¦æƒ…",-1)),e("button",{class:"refresh-button",disabled:$.value,onClick:te},[k(w,null,{default:D(()=>[k(L(Be))]),_:1}),t[29]||(t[29]=K(" åˆ·æ–°çŠ¶æ€ ",-1))],8,is)])]),default:D(()=>[e("div",rs,[(g(!0),_(ie,null,pe(z.value,u=>(g(),_("div",{key:u.id,class:"task-item"},[e("div",cs,[k(w,{class:J(["task-status-icon",{completed:u.completed}])},{default:D(()=>[u.completed?(g(),ve(L(Ve),{key:0})):(g(),ve(L(ct),{key:1}))]),_:2},1032,["class"]),e("span",us,x(u.name),1)]),k(H,{type:u.completed?"success":"default",size:"small"},{default:D(()=>[K(x(u.completed?"å·²å®Œæˆ":"æœªå®Œæˆ"),1)]),_:2},1032,["type"])]))),128))])]),_:1},8,["show"]),k(E,{show:A.value,"onUpdate:show":t[14]||(t[14]=u=>A.value=u),preset:"card",title:"ä»»åŠ¡æ‰§è¡Œæ—¥å¿—",style:{width:"500px"}},{header:D(()=>[e("div",ds,[k(w,null,{default:D(()=>[k(L(ot))]),_:1}),t[31]||(t[31]=e("span",null,"ä»»åŠ¡æ‰§è¡Œæ—¥å¿—",-1))])]),default:D(()=>[e("div",{ref_key:"logContainer",ref:S,class:"log-container"},[(g(!0),_(ie,null,pe(l.value,u=>(g(),_("div",{key:u.time+u.message,class:"log-item"},[e("span",ms,x(u.time),1),e("span",{class:J(["log-message",{error:u.type==="error",success:u.type==="success",warning:u.type==="warning"}])},x(u.message),3)]))),128))],512)]),_:1},8,["show"])])}}},vs=me(ps,[["__scopeId","data-v-887c3f6e"]]),gs={class:"tower-status-card"},fs={class:"card-header"},_s={class:"energy-display"},hs={class:"energy-count"},ys={class:"card-content"},ks={class:"tower-floor"},ws={class:"floor-number"},Ts={class:"card-actions"},bs=["disabled"],$s={__name:"TowerStatus",setup(Q){const a=ce(),i=ue(),r=B(!1),o=B(null);B(null);const A=M(()=>{var T;return((T=a.gameData)==null?void 0:T.roleInfo)||null}),$=M(()=>{var P,l;const h=(l=(P=A.value)==null?void 0:P.role)==null?void 0:l.tower;if(!h||!h.id&&h.id!==0)return"0 - 0";const T=h.id,C=Math.floor(T/10)+1,O=T%10+1;return`${C} - ${O}`}),S=M(()=>{var C,O;const h=(O=(C=A.value)==null?void 0:C.role)==null?void 0:O.tower;return(h==null?void 0:h.energy)||0}),f=M(()=>{const h=S.value>0,T=!r.value;return h&&T}),z=async()=>{if(!a.selectedToken){i.warning("è¯·å…ˆé€‰æ‹©Token");return}if(!f.value){i.warning("ä½“åŠ›ä¸è¶³æˆ–æ­£åœ¨çˆ¬å¡”ä¸­");return}o.value&&(clearTimeout(o.value),o.value=null),r.value=!0,o.value=setTimeout(()=>{r.value=!1,o.value=null},15e3);try{const h=a.selectedToken.id;await a.sendMessageWithPromise(h,"fight_starttower",{},1e4),i.success("çˆ¬å¡”å‘½ä»¤å·²å‘é€"),await W(),setTimeout(async()=>{await W(),o.value&&(clearTimeout(o.value),o.value=null),r.value=!1},2e3)}catch(h){i.error("çˆ¬å¡”å¤±è´¥: "+(h.message||"æœªçŸ¥é”™è¯¯")),o.value&&(clearTimeout(o.value),o.value=null),r.value=!1}},Y=()=>{o.value&&(clearTimeout(o.value),o.value=null),r.value=!1,i.info("çˆ¬å¡”çŠ¶æ€å·²é‡ç½®")},W=async()=>{if(!a.selectedToken){console.warn("ğŸ—¼ getTowerInfo: æ²¡æœ‰é€‰ä¸­çš„Token");return}try{const h=a.selectedToken.id;if(a.getWebSocketStatus(h)!=="connected")return;const C=a.sendMessage(h,"role_getroleinfo"),O=a.sendMessage(h,"tower_getinfo");!C&&!O&&console.error("ğŸ—¼ getTowerInfo: æ‰€æœ‰è¯·æ±‚éƒ½å¤±è´¥äº†")}catch(h){console.error("ğŸ—¼ getTowerInfo: è·å–å¡”ä¿¡æ¯å¤±è´¥:",h)}},G=M(()=>a.selectedToken?a.getWebSocketStatus(a.selectedToken.id):"disconnected");return ee(G,(h,T)=>{console.log(`ğŸ—¼ WebSocketçŠ¶æ€å˜åŒ–: ${T} -> ${h}`),h==="connected"&&T!=="connected"&&(console.log("ğŸ—¼ WebSocketå·²è¿æ¥ï¼Œè‡ªåŠ¨è·å–å¡”ä¿¡æ¯"),setTimeout(()=>{W()},1e3))}),ee(()=>a.selectedToken,(h,T)=>{h&&h.id!==(T==null?void 0:T.id)&&(console.log("ğŸ—¼ Tokenå·²åˆ‡æ¢ï¼Œè·å–æ–°çš„å¡”ä¿¡æ¯"),a.getWebSocketStatus(h.id)==="connected"&&W())}),ee(()=>a.gameData.towerResult,(h,T)=>{h&&h.timestamp!==(T==null?void 0:T.timestamp)&&(console.log("ğŸ—¼ æ”¶åˆ°æ–°çš„çˆ¬å¡”ç»“æœ:",h),h.success?(i.success("å’¸å°†å¡”æŒ‘æˆ˜æˆåŠŸï¼"),h.autoReward&&setTimeout(()=>{i.success(`è‡ªåŠ¨é¢†å–ç¬¬${h.rewardFloor}å±‚å¥–åŠ±`)},1e3)):i.error("å’¸å°†å¡”æŒ‘æˆ˜å¤±è´¥"),setTimeout(()=>{console.log("ğŸ—¼ çˆ¬å¡”ç»“æœå¤„ç†å®Œæˆï¼Œé‡ç½®çŠ¶æ€"),o.value&&(clearTimeout(o.value),o.value=null),r.value=!1},2e3))},{deep:!0}),de(()=>{a.selectedToken&&a.getWebSocketClient(a.selectedToken.id),a.selectedToken&&G.value==="connected"?W():a.selectedToken?console.log("ğŸ—¼ WebSocketæœªè¿æ¥ï¼Œç­‰å¾…è¿æ¥åè‡ªåŠ¨è·å–å¡”ä¿¡æ¯"):console.log("ğŸ—¼ æ²¡æœ‰é€‰ä¸­çš„Tokenï¼Œæ— æ³•è·å–å¡”ä¿¡æ¯")}),(h,T)=>(g(),_("div",gs,[e("div",fs,[T[1]||(T[1]=e("div",{class:"header-info"},[e("img",{src:be,alt:"çˆ¬å¡”å›¾æ ‡",class:"tower-icon"}),e("div",{class:"tower-info"},[e("h3",null,"å’¸å°†å¡”"),e("p",null,"ä¸€ä¸ªä¸å°å¿ƒå°±è¿‡äº†")])],-1)),e("div",_s,[T[0]||(T[0]=e("img",{src:Ue,alt:"å°é±¼å¹²",class:"energy-icon"},null,-1)),e("span",hs,x(S.value),1)])]),e("div",ys,[e("div",ks,[T[2]||(T[2]=e("span",{class:"label"},"å½“å‰å±‚æ•°",-1)),e("span",ws,x($.value),1)])]),e("div",Ts,[e("button",{class:J(["climb-button",{active:f.value,disabled:!f.value}]),disabled:!f.value,onClick:z},x(r.value.value?"çˆ¬å¡”ä¸­...":"å¼€å§‹çˆ¬å¡”"),11,bs),r.value.value?(g(),_("button",{key:0,class:"reset-button",onClick:Y}," é‡ç½®çŠ¶æ€ ")):re("",!0)])]))}},Ss=me($s,[["__scopeId","data-v-23f2c101"]]),xs={class:"game-status-container"},Cs={class:"status-card bottle-helper"},Is={class:"card-header"},Ms={class:"card-content"},Ds={class:"time-display"},Bs={class:"status-card hang-up"},Us={class:"card-header"},zs={class:"status-info"},Ws={class:"card-content"},Os={class:"time-display"},Es={class:"action-row"},As=["disabled"],Hs={key:0,class:"loading-text"},Ns={key:1},Rs=["disabled"],Ps={key:0,class:"loading-text"},Vs={key:1},Ls={class:"status-card legion-signin"},Gs={class:"card-header"},js={class:"card-content"},qs={key:0,class:"club-name"},Js={key:1,class:"description"},Qs=["disabled"],Xs={class:"status-card study"},Ys={class:"card-header"},Ks={class:"card-content"},Zs=["disabled"],Fs={key:0},en={key:1,class:"loading-text"},tn={key:0},sn={key:1},nn={key:2},an={key:3},on={key:4},ln={key:2},rn={__name:"GameStatus",setup(Q){const a=ce(),i=ue(),r=B({isRunning:!1,remainingTime:0,stopTime:0}),o=B({isActive:!1,remainingTime:0,elapsedTime:0,lastTime:0,hangUpTime:0,isExtending:!1,isClaiming:!1}),A=B({isRegistered:!1}),$=B({isSignedIn:!1,clubName:""}),S=M(()=>a.gameData.studyStatus),f=M(()=>{var l;return((l=a.gameData)==null?void 0:l.roleInfo)||null}),z=l=>{const s=Math.floor(Number(l)||0);if(s<=0)return"00:00:00";const n=Math.floor(s/3600),d=Math.floor(s%3600/60),m=s%60;return`${n.toString().padStart(2,"0")}:${d.toString().padStart(2,"0")}:${m.toString().padStart(2,"0")}`},Y=()=>{if(!f.value)return;const l=f.value.role;if(l.bottleHelpers){const s=Date.now()/1e3;r.value.stopTime=l.bottleHelpers.helperStopTime,r.value.isRunning=l.bottleHelpers.helperStopTime>s,r.value.remainingTime=Math.max(0,Math.floor(l.bottleHelpers.helperStopTime-s)),console.log("ğŸ¤– ç›ç½æœºå™¨äººçŠ¶æ€æ›´æ–°:",{stopTime:l.bottleHelpers.helperStopTime,now:s,remainingTime:r.value.remainingTime,isRunning:r.value.isRunning})}if(l.hangUp){const s=Date.now()/1e3;o.value.lastTime=l.hangUp.lastTime,o.value.hangUpTime=l.hangUp.hangUpTime;const n=s-o.value.lastTime;n<=o.value.hangUpTime?(o.value.remainingTime=Math.floor(o.value.hangUpTime-n),o.value.isActive=!0):(o.value.remainingTime=0,o.value.isActive=!1),o.value.elapsedTime=Math.floor(o.value.hangUpTime-o.value.remainingTime),console.log("â° æŒ‚æœºçŠ¶æ€æ›´æ–°:",{lastTime:o.value.lastTime,hangUpTime:o.value.hangUpTime,elapsed:n,remainingTime:o.value.remainingTime,elapsedTime:o.value.elapsedTime,isActive:o.value.isActive})}if(l.statistics){const s=new Date;s.setHours(0,0,0,0);const n=s.getTime()/1e3;A.value.isRegistered=Number(l.statistics["last:legion:match:sign:up:time"])>n}if(l.statisticsTime){const s=new Date;s.setHours(0,0,0,0);const n=s.getTime()/1e3;$.value.isSignedIn=l.statisticsTime["legion:sign:in"]>n}};let W=null;const G=()=>{W&&clearInterval(W),W=setInterval(()=>{r.value.isRunning&&r.value.remainingTime>0&&(r.value.remainingTime=Math.max(0,r.value.remainingTime-1),r.value.remainingTime<=0&&(r.value.isRunning=!1)),o.value.isActive&&o.value.remainingTime>0&&(o.value.remainingTime=Math.max(0,o.value.remainingTime-1),o.value.elapsedTime=o.value.elapsedTime+1,o.value.remainingTime<=0&&(o.value.isActive=!1))},1e3)},h=()=>{if(!a.selectedToken){i.warning("è¯·å…ˆé€‰æ‹©Token");return}const l=a.selectedToken.id;a.sendMessage(l,"bottlehelper_stop"),setTimeout(()=>{a.sendMessage(l,"bottlehelper_start"),a.sendMessage(l,"role_getroleinfo")},500),i.info(r.value.isRunning?"é‡å¯ç›ç½æœºå™¨äºº":"å¯åŠ¨ç›ç½æœºå™¨äºº")},T=async()=>{if(!a.selectedToken){i.warning("è¯·å…ˆé€‰æ‹©Token");return}const l=a.selectedToken.id;try{console.log("ğŸ• å¼€å§‹åŠ é’Ÿæ“ä½œ..."),o.value.isExtending=!0,i.info("æ­£åœ¨åŠ é’Ÿ...");const s=[];for(let n=0;n<4;n++){const d=new Promise(m=>{setTimeout(()=>{console.log(`ğŸ• å‘é€ç¬¬${n+1}æ¬¡åŠ é’Ÿè¯·æ±‚`);const y=a.sendMessage(l,"system_mysharecallback",{isSkipShareCard:!0,type:2});m(y)},n*300)});s.push(d)}await Promise.all(s),console.log("ğŸ• æ‰€æœ‰åŠ é’Ÿè¯·æ±‚å·²å‘é€"),setTimeout(()=>{console.log("ğŸ• åŠ é’Ÿåè·å–æœ€æ–°è§’è‰²ä¿¡æ¯"),a.sendMessage(l,"role_getroleinfo")},1500),setTimeout(()=>{i.success("åŠ é’Ÿæ“ä½œå·²å®Œæˆï¼Œè¯·æŸ¥çœ‹æŒ‚æœºå‰©ä½™æ—¶é—´"),o.value.isExtending=!1},2500)}catch(s){console.error("ğŸ• åŠ é’Ÿæ“ä½œå¤±è´¥:",s),i.error("åŠ é’Ÿæ“ä½œå¤±è´¥: "+(s.message||"æœªçŸ¥é”™è¯¯")),o.value.isExtending=!1}},C=async()=>{if(!a.selectedToken){i.warning("è¯·å…ˆé€‰æ‹©Token");return}const l=a.selectedToken.id;try{console.log("ğŸ å¼€å§‹é¢†å–æŒ‚æœºå¥–åŠ±..."),o.value.isClaiming=!0,i.info("æ­£åœ¨é¢†å–æŒ‚æœºå¥–åŠ±..."),a.sendMessage(l,"system_mysharecallback"),setTimeout(()=>{a.sendMessage(l,"system_claimhangupreward")},200),setTimeout(()=>{a.sendMessage(l,"system_mysharecallback",{isSkipShareCard:!0,type:2})},400),setTimeout(()=>{a.sendMessage(l,"role_getroleinfo")},600),setTimeout(()=>{i.success("æŒ‚æœºå¥–åŠ±é¢†å–å®Œæˆ"),o.value.isClaiming=!1},1200),console.log("ğŸ æŒ‚æœºå¥–åŠ±é¢†å–æ“ä½œåºåˆ—å·²å¯åŠ¨")}catch(s){console.error("ğŸ é¢†å–æŒ‚æœºå¥–åŠ±å¤±è´¥:",s),i.error("é¢†å–æŒ‚æœºå¥–åŠ±å¤±è´¥: "+(s.message||"æœªçŸ¥é”™è¯¯")),o.value.isClaiming=!1}},O=()=>{if(!a.selectedToken||$.value.isSignedIn)return;const l=a.selectedToken.id;a.sendMessage(l,"legion_signin"),a.sendMessage(l,"role_getroleinfo"),i.info("ä¿±ä¹éƒ¨ç­¾åˆ°")},P=async()=>{if(!(!a.selectedToken||S.value.isAnswering)){if(S.value.isCompleted){i.success("âœ… å’¸é±¼å¤§å†²å…³ä»»åŠ¡å·²å®Œæˆï¼Œæ— éœ€é‡å¤ä½œç­”ï¼");return}try{await ye();const l=await Me();a.gameData.studyStatus={...a.gameData.studyStatus,isAnswering:!0,questionCount:0,answeredCount:0,status:"starting",timestamp:Date.now()};const s=a.selectedToken.id;a.sendMessage(s,"study_startgame"),setTimeout(()=>{a.gameData.studyStatus.isAnswering&&(a.gameData.studyStatus={...a.gameData.studyStatus,isAnswering:!1,questionCount:0,answeredCount:0,status:"",timestamp:null},i.warning("ç­”é¢˜è¶…æ—¶ï¼Œå·²è‡ªåŠ¨é‡ç½®çŠ¶æ€"))},3e4),i.info(`ğŸš€ å¼€å§‹ä¸€é”®ç­”é¢˜... (é¢˜åº“åŒ…å« ${l} é“é¢˜ç›®)`)}catch(l){console.error("å¯åŠ¨ç­”é¢˜å¤±è´¥:",l),i.error("å¯åŠ¨ç­”é¢˜å¤±è´¥: "+l.message)}}};return ee(f,l=>{l&&Y()},{deep:!0,immediate:!0}),de(()=>{if(Y(),G(),ye().then(()=>{console.log("ğŸ“š ç­”é¢˜æ•°æ®é¢„åŠ è½½å®Œæˆ")}).catch(l=>{console.error("âŒ ç­”é¢˜æ•°æ®é¢„åŠ è½½å¤±è´¥:",l)}),a.selectedToken){const l=a.selectedToken.id;a.sendMessage(l,"legion_getinfo")}}),Te(()=>{W&&clearInterval(W)}),(l,s)=>(g(),_("div",xs,[k(Et),k(vs),k(Ss),e("div",Cs,[e("div",Is,[s[1]||(s[1]=e("img",{src:vt,alt:"ç›ç½å›¾æ ‡",class:"status-icon"},null,-1)),s[2]||(s[2]=e("div",{class:"status-info"},[e("h3",null,"ç›ç½æœºå™¨äºº"),e("p",null,"å‰©ä½™æ—¶é—´")],-1)),e("div",{class:J(["status-badge",{active:r.value.isRunning}])},[s[0]||(s[0]=e("div",{class:"status-dot"},null,-1)),e("span",null,x(r.value.isRunning?"è¿è¡Œä¸­":"å·²åœæ­¢"),1)],2)]),e("div",Ms,[e("div",Ds,x(z(r.value.remainingTime)),1),e("button",{class:"action-button",onClick:h},x(r.value.isRunning?"é‡å¯æœåŠ¡":"å¯åŠ¨æœåŠ¡"),1)])]),e("div",Bs,[e("div",Us,[s[5]||(s[5]=e("img",{src:gt,alt:"æŒ‚æœºå›¾æ ‡",class:"status-icon"},null,-1)),e("div",zs,[s[3]||(s[3]=e("h3",null,"æŒ‚æœºæ—¶é—´",-1)),e("p",null,"å·²æŒ‚æœºï¼š"+x(z(o.value.elapsedTime)),1)]),e("div",{class:J(["status-badge",{active:o.value.isActive}])},[s[4]||(s[4]=e("div",{class:"status-dot"},null,-1)),e("span",null,x(o.value.isActive?"æŒ‚æœºä¸­":"å·²å®Œæˆ"),1)],2)]),e("div",Ws,[e("div",Os,x(z(o.value.remainingTime)),1),e("div",Es,[e("button",{class:"action-button secondary",disabled:o.value.isExtending,onClick:T},[o.value.isExtending?(g(),_("span",Hs,s[6]||(s[6]=[e("svg",{class:"loading-icon",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M12 22c5.421 0 10-4.579 10-10h-2c0 4.337-3.663 8-8 8s-8-3.663-8-8c0-4.336 3.663-8 8-8V2C6.579 2 2 6.58 2 12c0 5.421 4.579 10 10 10z"})],-1),K(" åŠ é’Ÿä¸­... ",-1)]))):(g(),_("span",Ns,"åŠ é’Ÿ"))],8,As),e("button",{class:"action-button primary",disabled:o.value.isClaiming,onClick:C},[o.value.isClaiming?(g(),_("span",Ps,s[7]||(s[7]=[e("svg",{class:"loading-icon",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M12 22c5.421 0 10-4.579 10-10h-2c0 4.337-3.663 8-8 8s-8-3.663-8-8c0-4.336 3.663-8 8-8V2C6.579 2 2 6.58 2 12c0 5.421 4.579 10 10 10z"})],-1),K(" é¢†å–ä¸­... ",-1)]))):(g(),_("span",Vs,"é¢†å–å¥–åŠ±"))],8,Rs)])])]),e("div",Ls,[e("div",Gs,[s[9]||(s[9]=e("img",{src:be,alt:"ç­¾åˆ°å›¾æ ‡",class:"status-icon"},null,-1)),s[10]||(s[10]=e("div",{class:"status-info"},[e("h3",null,"ä¿±ä¹éƒ¨ç­¾åˆ°"),e("p",null,"æ¯æ—¥ç­¾åˆ°çŠ¶æ€")],-1)),e("div",{class:J(["status-badge",{active:$.value.isSignedIn}])},[s[8]||(s[8]=e("div",{class:"status-dot"},null,-1)),e("span",null,x($.value.isSignedIn?"å·²ç­¾åˆ°":"å¾…ç­¾åˆ°"),1)],2)]),e("div",js,[$.value.clubName?(g(),_("p",qs,[s[11]||(s[11]=K(" å½“å‰ä¿±ä¹éƒ¨",-1)),s[12]||(s[12]=e("br",null,null,-1)),e("strong",null,x($.value.clubName),1)])):(g(),_("p",Js," å°šæœªåŠ å…¥ä»»ä½•ä¿±ä¹éƒ¨ ")),e("button",{class:"action-button",disabled:$.value.isSignedIn,onClick:O},x($.value.isSignedIn?"å·²ç­¾åˆ°":"ç«‹å³ç­¾åˆ°"),9,Qs)])]),e("div",Xs,[e("div",Ys,[s[14]||(s[14]=e("img",{src:ft,alt:"å­¦ä¹ å›¾æ ‡",class:"status-icon"},null,-1)),s[15]||(s[15]=e("div",{class:"status-info"},[e("h3",null,"å’¸é±¼å¤§å†²å…³"),e("p",null,"æ¯æ—¥çŸ¥è¯†æŒ‘æˆ˜")],-1)),e("div",{class:J(["status-badge weekly",{completed:S.value.isCompleted}])},[e("div",{class:J(["status-dot",{completed:S.value.isCompleted}])},null,2),s[13]||(s[13]=e("span",null,"æ¯å‘¨ä»»åŠ¡",-1))],2)]),e("div",Ks,[s[17]||(s[17]=e("p",{class:"description"}," æ²¡æœ‰ä»€ä¹ˆå¯ä»¥é˜»æŒ¡æˆ‘æ±‚çŸ¥çš„æ¬²æœ›ï¼ ",-1)),e("button",{class:J(["action-button",{completed:S.value.isCompleted}]),disabled:S.value.isAnswering||S.value.isCompleted,onClick:P},[S.value.isCompleted?(g(),_("span",Fs," âœ… å·²å®Œæˆæ— éœ€ä½œç­” ")):S.value.isAnswering?(g(),_("span",en,[s[16]||(s[16]=e("svg",{class:"loading-icon",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M12 22c5.421 0 10-4.579 10-10h-2c0 4.337-3.663 8-8 8s-8-3.663-8-8c0-4.336 3.663-8 8-8V2C6.579 2 2 6.58 2 12c0 5.421 4.579 10 10 10z"})],-1)),S.value.status==="starting"?(g(),_("span",tn,"æ­£åœ¨è·å–é¢˜ç›®...")):S.value.status==="answering"?(g(),_("span",sn,"ç­”é¢˜ä¸­ "+x(S.value.answeredCount)+"/"+x(S.value.questionCount),1)):S.value.status==="claiming_rewards"?(g(),_("span",nn,"æ­£åœ¨é¢†å–å¥–åŠ±...")):S.value.status==="completed"?(g(),_("span",an,"ç­”é¢˜å®Œæˆ")):(g(),_("span",on,"ç­”é¢˜ä¸­..."))])):(g(),_("span",ln,"ğŸ¯ ä¸€é”®ç­”é¢˜"))],10,Zs)])])]))}},cn=me(rn,[["__scopeId","data-v-d084b52b"]]),un={class:"game-features-page"},dn={class:"page-header"},mn={class:"container"},pn={class:"header-content"},vn={class:"header-left flex items-center"},gn={class:"page-subtitle"},fn={class:"header-actions flex items-center"},_n={key:0,class:"feedback-section"},hn={class:"features-grid-section"},yn={class:"container"},kn={__name:"GameFeatures",setup(Q){var s;const a=De(),i=ue(),r=ce(),{isMobile:o}=ze(),A=B(!1),$=B(((s=r.selectedToken)==null?void 0:s.id)||null),S=M(()=>r.gameTokens.map(n=>({label:n.name,value:n.id}))),f=M(()=>{const n=r.gameTokens.find(d=>d.id===$.value);return(n==null?void 0:n.name)||"æœªé€‰æ‹©Token"}),z=B(!1),Y=n=>z.value=n,W=n=>{r.selectToken(n),C(),i.success(`å·²åˆ‡æ¢åˆ°Token: ${f.value}`)},G=M(()=>r.selectedToken&&r.getWebSocketStatus(r.selectedToken.id)==="connected"?"connected":"disconnected"),h=M(()=>r.selectedToken?r.getWebSocketStatus(r.selectedToken.id)==="connected"?"å·²è¿æ¥":"æœªè¿æ¥":"æœªé€‰æ‹©Token");M(()=>G.value==="connected"?"status-connected":"status-disconnected");const T=M(()=>G.value==="connected"),C=()=>{if(!r.selectedToken){i.warning("è¯·å…ˆé€‰æ‹©ä¸€ä¸ªToken"),a.push("/tokens");return}try{A.value=!0;const n=r.selectedToken.id,d=r.selectedToken.token;r.createWebSocketConnection(n,d),i.info("æ­£åœ¨å»ºç«‹ WebSocket è¿æ¥..."),setTimeout(async()=>{r.getWebSocketStatus(n)==="connected"&&(i.success("WebSocket è¿æ¥æˆåŠŸ"),await l(),A.value=!1)},2e3)}catch(n){console.error("WebSocketè¿æ¥å¤±è´¥:",n),i.error("WebSocketè¿æ¥å¤±è´¥")}},O=()=>{if(r.selectedToken){const n=r.selectedToken.id;r.closeWebSocketConnection(n),i.info("WebSocketè¿æ¥å·²æ–­å¼€")}},P=()=>{G.value==="connected"?O():C()};de(()=>{r.selectedToken&&(r.getWebSocketStatus(r.selectedToken.id)!=="connected"?C():l())});const l=async()=>{if(r.selectedToken)try{const n=r.selectedToken.id;console.log("ğŸ® åˆå§‹åŒ–æ¸¸æˆæ•°æ®..."),console.log("ğŸ® æ­£åœ¨è·å–è§’è‰²ä¿¡æ¯...");const d=r.sendMessage(n,"role_getroleinfo");console.log("ğŸ® è§’è‰²ä¿¡æ¯è¯·æ±‚ç»“æœ:",d),console.log("ğŸ® æ­£åœ¨è·å–å¡”ä¿¡æ¯...");const m=r.sendMessage(n,"tower_getinfo");console.log("ğŸ® å¡”ä¿¡æ¯è¯·æ±‚ç»“æœ:",m),console.log("ğŸ® æ­£åœ¨è·å–é˜Ÿä¼ä¿¡æ¯...");const y=r.sendMessage(n,"presetteam_getinfo");console.log("ğŸ® é˜Ÿä¼ä¿¡æ¯è¯·æ±‚ç»“æœ:",y),console.log("ğŸ® æ¸¸æˆæ•°æ®åˆå§‹åŒ–è¯·æ±‚å·²å‘é€")}catch(n){console.warn("åˆå§‹åŒ–æ¸¸æˆæ•°æ®å¤±è´¥:",n)}};return Te(()=>{}),(n,d)=>{const m=F("n-icon"),y=F("n-button"),I=F("n-popselect"),N=F("n-spin");return g(),_("div",un,[k(N,{show:A.value},{default:D(()=>[e("div",dn,[e("div",mn,[e("div",pn,[e("div",vn,[d[2]||(d[2]=e("h1",{class:"page-title mr-20px"},"æ¸¸æˆåŠŸèƒ½",-1)),e("div",gn,[k(I,{value:$.value,"onUpdate:value":[d[0]||(d[0]=ae=>$.value=ae),W],options:S.value,trigger:"click","onUpdate:show":Y},{default:D(()=>[k(y,{text:"","icon-placement":"right",type:"primary",size:"large"},{icon:D(()=>[z.value?(g(),ve(m,{key:0},{default:D(()=>[k(L(Ye))]),_:1})):(g(),ve(m,{key:1},{default:D(()=>[k(L(qe))]),_:1}))]),default:D(()=>[K(x(f.value||"æœªé€‰æ‹©Token")+" ",1)]),_:1})]),_:1},8,["value","options"])])]),e("div",fn,[e("div",{class:J(["connection-status mr-20px",G.value])},[k(m,null,{default:D(()=>[k(L(et))]),_:1}),e("span",null,x(h.value),1)],2),k(y,{text:"",onClick:P},{default:D(()=>[K(x(T.value?"æ–­å¼€è¿æ¥":"é‡æ–°è¿æ¥"),1)]),_:1}),k(y,{style:{"margin-left":"40px"},text:"",onClick:d[1]||(d[1]=ae=>L(a).back())},{default:D(()=>d[3]||(d[3]=[K("è¿”å›Tokenç®¡ç†",-1)])),_:1,__:[3]})])])])]),L(o)?re("",!0):(g(),_("div",_n)),e("div",hn,[e("div",yn,[k(cn)])])]),_:1},8,["show"])])}}},$n=me(kn,[["__scopeId","data-v-c816b1cf"]]);export{$n as default};
